<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Roblox Game Stats</title>
  <style>
    body {
  font-family: Arial, sans-serif;
  background-color: #1a1a1a;
  color: white;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  margin: 0;
}

#game-name {
  font-size: 40px;
  font-weight: bold;
  margin-bottom: 20px;
}

.stats-container {
  display: flex;
  flex-wrap: wrap; /* Allow stats to wrap to the next line */
  justify-content: center; /* Center the stats */
  align-items: center;
  width: 100%;
  margin-top: 20px;
  gap: 20px; /* Space between stats */
}

.stat {
  display: flex;
  flex-direction: column; /* Stack text and value vertically */
  align-items: center;
  font-weight: bold;
  padding: 20px;
  background-color: rgba(255, 255, 255, 0.1);
  border-radius: 8px;
  width: 550px; /* Set a fixed width */
  height: 250px;
  min-width: 150px;
  color: #ffffff;
}

.stat-text {
  padding-top: 0px;
  font-size: 20px; /* Smaller font for the text */
  margin-bottom: 0px;
  
}

.stat-value {
  padding-top: 30px;
  font-size: 150px; /* Larger font for the value */
  color: #49d412;
}

#last-updated {
  font-size: 18px;
  margin-top: 20px;
}

#api-error {
  background-color: #e74c3c;
  color: white;
  padding: 15px;
  border-radius: 8px;
  margin-top: 20px;
  font-size: 16px;
  font-weight: bold;
  width: 80%;
  max-width: 600px;
  text-align: center;
}

@media screen and (max-width: 768px) {
  .stat {
    font-size: 50px;
    width: 200px; /* Reduce width for smaller screens */
  }

  .stats-container {
    flex-direction: column;
  }

  .stat-text {
    font-size: 16px; /* Smaller text for mobile screens */
  }

  .stat-value {
    font-size: 60px; /* Smaller value for mobile screens */
  }
}

  </style>
  <!-- <link rel="stylesheet" href="styles.css"> -->
</head>
<body>
  <div id="api-error" class="api-error" style="display: none;"></div>
  <div id="game-name"> ðŸ§ª Lab Line  </div>
 <div id="last-updated">Last Updated: Just now</div>
  <div class="stats-container">
    <div class="stat">
      <div class="stat-text" id="concurrent-users-text">Concurrent Users</div>
      <div class="stat-value" id="concurrent-users">0</div> 
    </div>
    <div class="stat">
      <div class="stat-text" id="total-visits-text">Total Visits</div>
      <div class="stat-value" id="total-visits">0</div>
    </div>
    <div class="stat">
      <div class="stat-text" id="favorited-count-text">Favorited Count</div>
      <div class="stat-value" id="favorited-count">0</div>
    </div>
    <!-- <div class="stat">
      <div class="stat-text" id="upvotes-text">Upvotes</div>
      <div class="stat-value" id="upvotes">0</div>
    </div>
    <div class="stat">
      <div class="stat-text" id="downvotes-text">Downvotes</div>
      <div class="stat-value" id="downvotes">0</div>
    </div>
    <div class="stat">
      <div class="stat-text" id="upvote-percentage-text">Upvote Percentage</div>
      <div class="stat-value" id="upvote-percentage">0%</div>
    </div> -->
  </div>

 
  
  <script>const apiUrl = "https://games.roproxy.com/v1/games?universeIds=6585982530"; // Updated to roproxy.com
    const VotesAPIurl = "https://games.roproxy.com/v1/games/votes?universeIds=6585982530"
    const refreshInterval = 15000; // 1 second
    
    const gameNameElement = document.getElementById("game-name");
    const concurrentUsersElement = document.getElementById("concurrent-users");
    const totalVisitsElement = document.getElementById("total-visits");
    const favoritedCountElement = document.getElementById("favorited-count");
    const lastUpdatedElement = document.getElementById("last-updated");
    const upvotesElement = document.getElementById("upvotes");
    const downvotesElement = document.getElementById("downvotes");
    const upvotePercentageElement = document.getElementById("upvote-percentage");
    
    let currentStats = { concurrentUsers: 0, totalVisits: 0, favoritedCount: 0, gameName: "", lastUpdated: 0, likes: 0, dislikes: 0, ratio: 0 };
    
    async function fetchStats() {
      try {
        const response = await fetch(apiUrl);
        const data = await response.json();
    
        // Extracting stats from the API response
        const gameData = data.data[0];
        const newStats = {
          concurrentUsers: gameData.playing || 0,
          totalVisits: gameData.visits || 0,
          favoritedCount: gameData.favoritedCount || 0,
          gameName: gameData.name || "Unknown Game",
          lastUpdated: new Date(gameData.updated) // Store the time of this update
        };
    
        // const votesResponse = await fetch(VotesAPIurl);
        // const votesData = await votesResponse.json();
        // const votes = votesData.data[0];
    
        // newStats.likes = votes.upVotes || 0;
        // newStats.dislikes = votes.downVotes || 0;
    
        // const totalVotes = newStats.likes + newStats.dislikes;
        // newStats.ratio = totalVotes > 0 ? (newStats.likes / totalVotes) * 100 : 0;
        // updateCounter(upvotesElement, currentStats.likes, newStats.likes)
        // updateCounter(downvotesElement, currentStats.dislikes, newStats.dislikes, "")
    
        // updateCounter(upvotePercentageElement, currentStats.ratio, newStats.ratio, "%")
    
    
        // Update the game name and counters
        gameNameElement.textContent = newStats.gameName; // Set the game name
        updateCounter(concurrentUsersElement, currentStats.concurrentUsers, newStats.concurrentUsers, "");
        updateCounter(totalVisitsElement, currentStats.totalVisits, newStats.totalVisits, "");
        updateCounter(favoritedCountElement, currentStats.favoritedCount, newStats.favoritedCount, "");
    
     
        // Update the last updated time
        updateLastUpdated(newStats.lastUpdated);
    
        // Save current stats
        currentStats = newStats;
      } catch (error) {
        console.error("Error fetching stats:", error);
      }
    }
    
    function updateCounter(element, oldValue, newValue, add) {
      if (oldValue === newValue) {
        return;
      }
    
      let currentValue = oldValue;
      const calculateStep = (remaining) => {
        if (remaining < 10) return 0.1;
        if (remaining < 25) return 0.25;
        if (remaining < 50) return 0.5;
        if (remaining < 100) return Math.ceil(remaining / 5); // Medium jump
        if (remaining > 100) return Math.floor(remaining / 2.5); // Large jump
        return 1; // Slow final approach
      };
    
      element.classList.add("updating");
    
      const interval = setInterval(() => {
        const remaining = Math.abs(newValue - currentValue);
        const step = calculateStep(remaining);
    
        if (currentValue < newValue) {
          currentValue += step;
          if (currentValue > newValue) currentValue = newValue; // Prevent overshooting
        } else {
          currentValue -= step;
          if (currentValue < newValue) currentValue = newValue; // Prevent overshooting
        }
    
        element.textContent = `${Math.round(currentValue)}${add}`;
    
        if (currentValue === newValue) {
          clearInterval(interval);
          element.classList.remove("updating");
        }
      }, 10); // Interval speed
    }
    
    function updateLastUpdated(lastUpdated) {
      const now = Date.now();
      const diff = now - lastUpdated;
      const seconds = Math.floor(diff / 1000);
      const minutes = Math.floor(seconds / 60);
      const hours = Math.floor(minutes / 60);
      const days = Math.floor(hours / 24);
      const years = Math.floor(days / 365);
    
      let timeAgo = "";
    
      if (seconds < 60) {
        timeAgo = `${seconds} seconds ago`;
      } else if (minutes < 60) {
        timeAgo = `${minutes} minute${minutes > 1 ? "s" : ""} ago`;
      } else if (hours < 24) {
        timeAgo = `${hours} hour${hours > 1 ? "s" : ""} ago`;
      } else if (days < 365) {
        timeAgo = `${days} day${days > 1 ? "s" : ""} ago`;
      } else {
        timeAgo = `${years} year${years > 1 ? "s" : ""} ago`;
      }
    
      lastUpdatedElement.textContent = `Last Updated: ${timeAgo}`;
    }
    
    setInterval(fetchStats, refreshInterval);
    fetchStats(); // Initial fetch
    </script>
</body>
</html>
